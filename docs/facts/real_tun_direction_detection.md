# Real TUN Direction Detection Fact

In real TUN mode the simulator determines packet direction using CIDR prefix matching for both IPv4 and IPv6. Packets are classified as ingress on TUN A or TUN B based on whether their source IP matches the configured `tun_a_prefix`/`tun_a_ipv6_prefix` or `tun_b_prefix`/`tun_b_ipv6_prefix`. The default IPv6 prefixes are now `::/0`, matching all IPv6 addresses. If no prefix matches, the simulator falls back to a heuristic based on the originating interface name. This approach supports both IPv4 and IPv6 traffic and aligns with the logic in `src/tun/mod.rs`.